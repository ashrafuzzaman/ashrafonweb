<% js_caching = RefinerySetting.find_or_set(:use_resource_caching, Rails.root.join('public', 'javascripts', 'cache').writable?) -%>
<% content_for :head do %>
  <%= jquery_include_tags(:caching => js_caching) %>

  <script type="text/javascript" src="/javascripts/jquery.bpopup.js"></script>

  <script type="text/javascript">
    function attatch_popup(element_id) {
      $('#'+ element_id).click(function() {
        $('#popup_content'+ element_id).openPopup({amsl:50, fadeSpeed:500, opacity:0.8});
        return false;
      });
    }

    $(document).ready(function(){
  <% @portfolios.each do |portfolio| %>
      attatch_popup("<%= portfolio.id %>");
  <% end %>
  });
  </script>

  <style type="text/css">
    #portfolios img {
      border: 2px solid #A89479;
      -moz-box-shadow: 5px 5px 5px #333;
      -webkit-box-shadow: 5px 5px 5px #333;
      -moz-border-radius: 5px;
      -webkit-border-radius: 5px;
      cursor: pointer;
    }

    #portfolios .portfolio_thum {
      margin: 0px 10px 20px 10px;
      float: left;
    }

    #portfolios span {
      text-shadow: 0px 1px 1px #000;
    }

    .popup {
      background: #6C5D48;
      border: 2px solid #A89479;
      -moz-box-shadow: 0px 0px 7px #777;
      -webkit-box-shadow: 0px 0px 7px #777;
      -moz-border-radius: 5px;
      -webkit-border-radius: 5px;
      width: 800px;
    }
    .popup .bClose {
      cursor: pointer;
    }
    .popup h2{
      color: #BEB09A;
      margin: 0px;
    }
    .popup .title {
      padding: 7px 12px 7px 12px;
      background: #322511;
      text-shadow: 0px 1px 1px #000;
    }
    .popup .content{
      margin: 10px;
    }
    .popup .content img{
      margin: 0px 10px 10px 0px;
      border: 2px solid #A89479;
      -moz-box-shadow: 5px 5px 5px #333;
      -webkit-box-shadow: 5px 5px 5px #333;
      -moz-border-radius: 5px;
      -webkit-border-radius: 5px;

    }
    .popup p{
      color: #DFDCD8;
    }
  </style>
<% end %>

<% content_for :body_content_left do %>
  <div id="portfolios">
    <% @portfolios.each do |portfolio| %>
      <div class="portfolio_thum"style="text-align: center;">
        <img id="<%= portfolio.id %>" style="margin-bottom: 2px;" src="<%= portfolio.thumb_url %>" alt="<%= portfolio.title %>" /><br/>
        <span><%= portfolio.title %></span>
      </div>
    <% end %>
  </div>
<% end %>

<%= render :partial => "/shared/content_page" %>

<% @portfolios.each do |portfolio| %>
  <div class="popup" style="display: none;" id="popup_content<%= portfolio.id %>">
    <div class="title"><h2><%= portfolio.title %><span style="float: right;" class="bClose close_icon"></span></h2></div>
    <div class="content" style="clear: both;">
      <a target="_blank" href="<%= portfolio.image_url %>">
        <img style="float: left;" width="400" src="<%= portfolio.image_url %>" alt="<%= portfolio.title %>" />
      </a>
      <div><%= portfolio.description %></div>
    </div>
  </div>
<% end %>
